<ngx-spinner bdColor="rgba(0,0,0,0.5)" size="medium" color="#fff" type="ball-spin-clockwise-fade-rotating">
</ngx-spinner>
<app-breadcrumbs title="Detail Ring One" [breadcrumbItems]="breadCrumbItems"></app-breadcrumbs>

<div class="row mt-5" @slideInLeftDetail>
  <div class="col-lg-12">
    <div class="card card-result animated-element">
      <div
        class="card-header animated-element card-result d-flex justify-content-center align-items-center bg-result position-relative">
        <button type="button" (click)="navigateToBack()"
          class="btn btn-custom-back btn-icon waves-effect waves-light position-absolute start-0">
          <i class="ri-arrow-left-s-line"></i>
        </button>
        <h3 class="mb-0">Ring 1 Information : {{ productLotNo }}</h3>
      </div>

      <div class="card-body p-3">

        <div class="card-body form-steps">
          <form class="vertical-navs-step">
            <div class="row gy-5">
              <div class="col-lg-2">
                <div role="tablist" aria-orientation="vertical">
                  <ul ngbNav #customNav="ngbNav" [activeId]="1" class="nav flex-column custom-nav nav-pills"
                    role="tablist">
                    <!-- IPC Quality Result -->
                    <li [ngbNavItem]="1" class="nav-item">
                      <a ngbNavLink class="nav-link animated-element" data-bs-toggle="tab" role="tab"
                        (click)="toggleTabIpc('Filling Volume','result_ipcquality_fillingVolume')">
                        <span class="step-title me-2">
                          IPC Quality Result
                        </span>
                      </a>
                      <ng-template ngbNavContent>
                        <div class="tab-container-ipc">
                          <div class="tab-box-ipc" [class.active]="activeTabIpc === 'Filling Volume'"
                            (click)="toggleTabIpc('Filling Volume','result_ipcquality_fillingVolume')">
                            Filling Volume
                          </div>
                          <div class="tab-box-ipc" [class.active]="activeTabIpc === 'brix'"
                            (click)="toggleTabIpc('brix','result_ipcquality_brix')">
                            Brix
                          </div>
                          <div class="tab-box-ipc" [class.active]="activeTabIpc === 'pH'"
                            (click)="toggleTabIpc('pH','result_ipcquality_ph')">
                            pH
                          </div>
                          <div class="tab-box-ipc" [class.active]="activeTabIpc === 'Sodium content'"
                            (click)="toggleTabIpc('Sodium content','result_ipcquality_sodiumContent')">
                            Sodium Content
                          </div>
                          <div class="tab-box-ipc" [class.active]="activeTabIpc === 'acidity'"
                            (click)="toggleTabIpc('acidity','result_ipcquality_acidity')">
                            Acidity
                          </div>
                        </div>


                        <div class="tab-content">
                          <ng-container>
                            <div class="row">
                              <!-- Filtering Table Data -->
                              <div class="col-md-6">
                                <div class="search-box">
                                  <input type="text" #searchInput class="form-control search" placeholder="Search..."
                                    (input)="onSearchAll(searchInput.value)" />
                                  <i class="ri-search-line search-icon"></i>
                                </div>
                              </div>
                              <div class="col-md-6">
                                <div style="float: right;">
                                  <span style="margin-right: 4px;">Show</span>
                                  <select class="data rounded-3" id="pageSizeDropdown" #pageSizeDropdown
                                    [value]="pageSize" (change)="onPageSizeChange(pageSizeDropdown.value)">
                                    <option value="1">1</option>
                                    <option value="5">5</option>
                                    <option value="10">10</option>
                                    <option value="15">15</option>
                                    <option value="20">20</option>
                                    <option value="25">25</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                  </select>
                                  <span style="margin-left: 4px;">Data</span>
                                </div>
                              </div>
                            </div>
                            <div class="row mt-3">
                              <div class="table-responsive">
                                <table class="table table-gridjs">
                                  <thead>
                                    <tr>
                                      <th scope="col" class="text-center">No</th>
                                      <th scope="col">Lot No</th>
                                      <th scope="col">Pro</th>
                                      <th scope="col">Sampel Ke</th>
                                      <th scope="col">Waktu Analisa</th>
                                      <th scope="col">Petugas</th>
                                      <th scope="col">Hasil</th>
                                      <th scope="col">Passable</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr *ngFor="let data of listData; let i = index">
                                      <ng-container *ngIf="i >= (page - 1) * pageSize && i < page * pageSize">
                                        <td class="text-center">{{ i + 1 }}</td>
                                        <td>{{ data['lotno'] }}</td>
                                        <td>{{ data['pro_fg'] }}</td>
                                        <td>{{ data['urutan_sample'] }}</td>
                                        <td>{{ data['time'] }}</td>
                                        <td>{{ data['petugas'] }}</td>
                                        <td>{{ data['hasil2'] }}</td>
                                        <td>
                                          <span class="badge rounded-pill"
                                            [class.text-bg-success]="checkPassDataIPC(data['min'], data['max'], data['hasil2']) === 'PASS'"
                                            [class.text-bg-danger]="checkPassDataIPC(data['min'], data['max'], data['hasil2']) === 'NOT PASS'"
                                            style="font-size: 13px;">
                                            {{ checkPassDataIPC(data['min'], data['max'], data['hasil2']) }}
                                          </span>
                                        </td>
                                      </ng-container>
                                    </tr>
                                    <tr *ngIf="listData?.length == 0">
                                      <td colspan="8" class="text-center">No data available.</td>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                              <!-- End Table Data -->
                              <!-- Pagination -->
                              <div class="row justify-content-md-between align-items-md-center">
                                <div class="col col-sm-6">
                                  <div class="dataTables_info mb-2" id="tickets-table_info" role="status"
                                    aria-live="polite">
                                    {{ getShowingText() }} of {{ totalRecords }} entries
                                  </div>
                                </div>
                                <div class="col col-sm-6">
                                  <div class="pagination justify-content-end">
                                    <ngb-pagination [collectionSize]="totalRecords" [(page)]="page"
                                      [pageSize]="pageSize" [maxSize]="3" [ellipses]="false"></ngb-pagination>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </ng-container>
                        </div>
                      </ng-template>
                    </li>
                    <li [ngbNavItem]="2" class="nav-item">
                      <a ngbNavLink class="nav-link animated-element" data-bs-toggle="tab" role="tab"
                        (click)="fetchDataResultMicrobiology('result_microbiology')">
                        <span class="step-title me-2">
                          Microbiology Result
                        </span>
                      </a>
                      <ng-template ngbNavContent>
                        <div class="tab-content">
                          <ng-container>
                            <div class="row">
                              <!-- Filtering Table Data -->
                              <div class="col-md-6">
                                <div class="search-box">
                                  <input type="text" #searchInput class="form-control search" placeholder="Search..."
                                    (input)="onSearchAll(searchInput.value)" />
                                  <i class="ri-search-line search-icon"></i>
                                </div>
                              </div>
                              <div class="col-md-6">
                                <div style="float: right;">
                                  <span style="margin-right: 4px;">Show</span>
                                  <select class="data rounded-3" id="pageSizeDropdown" #pageSizeDropdown
                                    [value]="pageSize" (change)="onPageSizeChange(pageSizeDropdown.value)">
                                    <option value="1">1</option>
                                    <option value="5">5</option>
                                    <option value="10">10</option>
                                    <option value="15">15</option>
                                    <option value="20">20</option>
                                    <option value="25">25</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                  </select>
                                  <span style="margin-left: 4px;">Data</span>
                                </div>
                              </div>
                            </div>
                            <div class="row mt-3">
                              <div class="table-responsive">
                                <table class="table table-gridjs">
                                  <thead>
                                    <tr>
                                      <th scope="col" class="text-center">No</th>
                                      <th scope="col">Lot No</th>
                                      <th scope="col">Pro</th>
                                      <th scope="col">Tanggal Analisa</th>
                                      <th scope="col">Petugas Analisa</th>
                                      <th scope="col">Petugas Sampling</th>
                                      <th scope="col">Bakteri</th>
                                      <th scope="col">Yeast</th>
                                      <th scope="col">TAB</th>
                                      <th scope="col">Staphylococcus aureus</th>
                                      <th scope="col">Pseudomonas aeruginosa</th>
                                      <th scope="col">Coliform</th>
                                      <th scope="col">Passable</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr *ngFor="let data of listData; let i = index">
                                      <ng-container *ngIf="i >= (page - 1) * pageSize && i < page * pageSize">
                                        <td class="text-center">{{ i + 1 }}</td>
                                        <td>{{ data['lotno'] }}</td>
                                        <td>{{ data['pro'] }}</td>
                                        <td>{{ data['tgl_analisa'] }}</td>
                                        <td>{{ data['petugas_analisa'] }}</td>
                                        <td>{{ data['petugas_sampling'] }}</td>
                                        <td>{{ data['tb'] }}</td>
                                        <td>
                                          <span class="badge rounded-pill"
                                            [class.text-bg-primary]="checkPassDataMicrobiologyIfOK(data['total_yeast']) === 'OK'"
                                            [class.text-bg-danger]="checkPassDataMicrobiologyIfOK(data['total_yeast']) !== 'OK'"
                                            style="font-size: 13px;">
                                            {{ checkPassDataMicrobiologyIfOK(data['total_yeast']) }}
                                          </span>
                                        </td>
                                        <td>
                                          <span class="badge rounded-pill"
                                            [class.text-bg-primary]="checkPassDataMicrobiologyIfOK(data['tab']) === 'OK'"
                                            [class.text-bg-danger]="checkPassDataMicrobiologyIfOK(data['tab']) !== 'OK'"
                                            style="font-size: 13px;">
                                            {{ checkPassDataMicrobiologyIfOK(data['tab']) }}
                                          </span>
                                        </td>
                                        <td>
                                          <span class="badge rounded-pill"
                                            [class.text-bg-primary]="checkPassDataMicrobiologyIfOK(data['staphy']) === 'OK'"
                                            [class.text-bg-danger]="checkPassDataMicrobiologyIfOK(data['staphy']) !== 'OK'"
                                            style="font-size: 13px;">
                                            {{ checkPassDataMicrobiologyIfOK(data['staphy']) }}
                                          </span>
                                        </td>
                                        <td>
                                          <span class="badge rounded-pill"
                                            [class.text-bg-primary]="checkPassDataMicrobiologyIfOK(data['pseudo']) === 'OK'"
                                            [class.text-bg-danger]="checkPassDataMicrobiologyIfOK(data['pseudo']) !== 'OK'"
                                            style="font-size: 13px;">
                                            {{ checkPassDataMicrobiologyIfOK(data['pseudo']) }}
                                          </span>
                                        </td>
                                        <td>
                                          <span class="badge rounded-pill"
                                            [class.text-bg-primary]="checkPassDataMicrobiologyIfOK(data['coliform']) === 'OK'"
                                            [class.text-bg-danger]="checkPassDataMicrobiologyIfOK(data['coliform']) !== 'OK'"
                                            style="font-size: 13px;">
                                            {{ checkPassDataMicrobiologyIfOK(data['coliform']) }}
                                          </span>
                                        </td>
                                        <td>
                                          <span class="badge rounded-pill"
                                            [class.text-bg-success]="checkPassDataMicrobiology(data['total_yeast'], data['tab'], data['staphy'], data['pseudo'], data['coliform']) === 'PASS'"
                                            [class.text-bg-danger]="checkPassDataMicrobiology(data['total_yeast'], data['tab'], data['staphy'], data['pseudo'], data['coliform']) === 'NOT PASS'"
                                            style="font-size: 13px;">
                                            {{ checkPassDataMicrobiology(data['total_yeast'], data['tab'],
                                            data['staphy'], data['pseudo'], data['coliform']) }}
                                          </span>
                                        </td>
                                      </ng-container>
                                    </tr>
                                    <tr *ngIf="listData?.length == 0">
                                      <td colspan="13" class="text-center">No data available.</td>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                              <!-- End Table Data -->
                              <!-- Pagination -->
                              <div class="row justify-content-md-between align-items-md-center">
                                <div class="col col-sm-6">
                                  <div class="dataTables_info mb-2" id="tickets-table_info" role="status"
                                    aria-live="polite">
                                    {{ getShowingText() }} of {{ totalRecords }} entries
                                  </div>
                                </div>
                                <div class="col col-sm-6">
                                  <div class="pagination justify-content-end">
                                    <ngb-pagination [collectionSize]="totalRecords" [(page)]="page"
                                      [pageSize]="pageSize" [maxSize]="3" [ellipses]="false"></ngb-pagination>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </ng-container>
                        </div>
                      </ng-template>
                    </li>
                    <li [ngbNavItem]="3" class="nav-item">
                      <a ngbNavLink class="nav-link animated-element" data-bs-toggle="tab" role="tab"
                        (click)="fetchDataResultBottleDimension('result_bottle_dimension')">
                        <span>
                          Bottle Dimension Result
                        </span>
                      </a>
                      <ng-template ngbNavContent>
                        <div class="tab-content">
                          <ng-container>
                            <div class="row">
                              <div class="col-xl-3 col-md-6">
                                <div class="row">
                                  <div *ngFor="let section of dataSectionsBottleDimension" class="col-lg-12">
                                    <div class="card card-animate no-shadow-{{ section.color }}"
                                      (click)="toggleTabBottleDimension(section)">
                                      <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                          <div>
                                            <h5 class="mb-3 text-primary">
                                              {{ section.title }}
                                            </h5>
                                            <div class="d-flex mb-1">
                                              <p class="text-truncate fw-bold fs-15 mb-0">
                                                max: {{ formatNumber(tabDataBottle?.[0]?.[section.maxKey]) || 'N/A' }}
                                              </p>
                                            </div>
                                            <div class="d-flex mb-1">
                                              <p class="text-truncate fw-bold fs-15 mb-0">
                                                min: {{ formatNumber(tabDataBottle?.[0]?.[section.minKey]) || 'N/A' }}
                                              </p>
                                            </div>
                                            <div class="d-flex mb-1">
                                              <p class="text-truncate fw-bold fs-15 mb-0">
                                                avg: {{ formatNumber(tabDataBottle?.[0]?.[section.avgKey]) || 'N/A' }}
                                              </p>
                                            </div>

                                          </div>
                                          <div>
                                            <i-feather name="external-link"
                                              class="text-primary feather-icon-align"></i-feather>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>

                                  <!-- end col -->
                                </div>
                                <!-- end row -->
                              </div>
                              <!-- Filtering Table Data -->
                              <div class="col-xl-9 col-md-6">
                                <div class="row">
                                  <!-- Filtering Table Data -->
                                  <div class="col-md-6">
                                    <div class="search-box">
                                      <input type="text" #searchInput class="form-control search"
                                        placeholder="Search..." (input)="onSearchAll(searchInput.value)" />
                                      <i class="ri-search-line search-icon"></i>
                                    </div>
                                  </div>
                                  <div class="col-md-6">
                                    <div style="float: right;">
                                      <span style="margin-right: 4px;">Show</span>
                                      <select class="data rounded-3" id="pageSizeDropdown" #pageSizeDropdown
                                        [value]="pageSize" (change)="onPageSizeChange(pageSizeDropdown.value)">
                                        <option value="1">1</option>
                                        <option value="5">5</option>
                                        <option value="10">10</option>
                                        <option value="15">15</option>
                                        <option value="20">20</option>
                                        <option value="25">25</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                      </select>
                                      <span style="margin-left: 4px;">Data</span>
                                    </div>
                                  </div>
                                </div>
                                <div class="row mt-3">
                                  <div class="table-responsive">
                                    <table class="table table-gridjs">
                                      <thead>
                                        <tr>
                                          <th scope="col" class="text-center">No</th>
                                          <th scope="col">Lot No</th>
                                          <th scope="col">Pro</th>
                                          <th scope="col">Nomer Cav</th>
                                          <th scope="col">Petugas</th>
                                          <th scope="col">Jenis Botol</th>
                                          <th scope="col">STD {{ dynamicHeader }}</th>
                                          <th scope="col">{{ dynamicHeader }}</th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        <tr *ngFor="let data of listData; let i = index">
                                          <ng-container *ngIf="i >= (page - 1) * pageSize && i < page * pageSize">
                                            <td class="text-center">{{ i + 1 }}</td>
                                            <td>{{ data['lotno'] }}</td>
                                            <td>{{ data['pro'] }}</td>
                                            <td>{{ data['nomer_cav'] }}</td>
                                            <td>{{ data['petugas'] }}</td>
                                            <td>{{ data['jenis_botol'] }}</td>
                                            <td>{{ data[dynamicField] || 'N/A' }}</td>
                                            <td>{{ data[dynamicFieldData] || 'N/A' }}</td>
                                          </ng-container>
                                        </tr>
                                        <tr *ngIf="listData?.length == 0">
                                          <td colspan="7" class="text-center">No data available.</td>
                                        </tr>
                                      </tbody>
                                    </table>
                                  </div>
                                  <!-- End Table Data -->
                                  <!-- Pagination -->
                                  <div class="row justify-content-md-between align-items-md-center">
                                    <div class="col col-sm-6">
                                      <div class="dataTables_info mb-2" id="tickets-table_info" role="status"
                                        aria-live="polite">
                                        {{ getShowingText() }} of {{ totalRecords }} entries
                                      </div>
                                    </div>
                                    <div class="col col-sm-6">
                                      <div class="pagination justify-content-end">
                                        <ngb-pagination [collectionSize]="totalRecords" [(page)]="page"
                                          [pageSize]="pageSize" [maxSize]="3" [ellipses]="false"></ngb-pagination>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </ng-container>
                        </div>
                      </ng-template>
                    </li>
                    <li [ngbNavItem]="4" class="nav-item">
                      <a ngbNavLink class="nav-link animated-element" data-bs-toggle="tab" role="tab"
                      (click)="fetchDataResultCappingPerformance('result_capping_performance')">
                        <span class="step-title me-2">
                          Capping Performance Result
                        </span>
                      </a>
                      <ng-template ngbNavContent>
                        <div class="tab-content">
                          <ng-container>
                            <div class="row">
                              <div class="col-xl-3 col-md-6">
                                <div class="row">
                                  <div *ngFor="let section of dataSectionsCappingPerformance" class="col-lg-12">
                                    <div class="card card-animate no-shadow-{{ section.color }}"
                                      (click)="toggleTabCappingPerformance(section)">
                                      <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                          <div>
                                            <h5 class="mb-3 text-primary">
                                              {{ section.title }}
                                            </h5>
                                            <div class="d-flex mb-1">
                                              <p class="text-truncate fw-bold fs-15 mb-0">
                                                max: {{ formatNumber(tabDataCapping?.[0]?.[section.maxKey]) || 'N/A' }}
                                              </p>
                                            </div>
                                            <div class="d-flex mb-1">
                                              <p class="text-truncate fw-bold fs-15 mb-0">
                                                min: {{ formatNumber(tabDataCapping?.[0]?.[section.minKey]) || 'N/A' }}
                                              </p>
                                            </div>
                                            <div class="d-flex mb-1">
                                              <p class="text-truncate fw-bold fs-15 mb-0">
                                                avg: {{ formatNumber(tabDataCapping?.[0]?.[section.avgKey]) || 'N/A' }}
                                              </p>
                                            </div>

                                          </div>
                                          <div>
                                            <i-feather name="external-link"
                                              class="text-primary feather-icon-align"></i-feather>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>

                                  <!-- end col -->
                                </div>
                                <!-- end row -->
                              </div>
                              <!-- Filtering Table Data -->
                              <div class="col-xl-9 col-md-6">
                                <div class="row">
                                  <!-- Filtering Table Data -->
                                  <div class="col-md-6">
                                    <div class="search-box">
                                      <input type="text" #searchInput class="form-control search"
                                        placeholder="Search..." (input)="onSearchAll(searchInput.value)" />
                                      <i class="ri-search-line search-icon"></i>
                                    </div>
                                  </div>
                                  <div class="col-md-6">
                                    <div style="float: right;">
                                      <span style="margin-right: 4px;">Show</span>
                                      <select class="data rounded-3" id="pageSizeDropdown" #pageSizeDropdown
                                        [value]="pageSize" (change)="onPageSizeChange(pageSizeDropdown.value)">
                                        <option value="1">1</option>
                                        <option value="5">5</option>
                                        <option value="10">10</option>
                                        <option value="15">15</option>
                                        <option value="20">20</option>
                                        <option value="25">25</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                      </select>
                                      <span style="margin-left: 4px;">Data</span>
                                    </div>
                                  </div>
                                </div>
                                <div class="row mt-3">
                                  <div class="table-responsive">
                                    <table class="table table-gridjs">
                                      <thead>
                                        <tr>
                                          <th scope="col" class="text-center">No</th>
                                          <th scope="col">Lot No</th>
                                          <th scope="col">Pro</th>
                                          <th scope="col">Nomer Cav</th>
                                          <th scope="col">Sampling</th>
                                          <th scope="col">Urutan Sample</th>
                                          <th scope="col">Jenis Capping</th>
                                          <th scope="col">Petugas</th>
                                          <th scope="col">Jenis Botol</th>
                                          <th scope="col">STD {{ dynamicHeader }}</th>
                                          <th scope="col">{{ dynamicHeader }}</th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        <tr *ngFor="let data of listData; let i = index">
                                          <ng-container *ngIf="i >= (page - 1) * pageSize && i < page * pageSize">
                                            <td class="text-center">{{ i + 1 }}</td>
                                            <td>{{ data['lotno'] }}</td>
                                            <td>{{ data['pro'] }}</td>
                                            <td>{{ data['nomer_cav'] }}</td>
                                            <td>{{ data['Sampling'] }}</td>
                                            <td>{{ data['Urutan Sample'] }}</td>
                                            <td>{{ data['jenis_cap'] }}</td>
                                            <td>{{ data['petugas'] }}</td>
                                            <td>{{ data['product'] }}</td>
                                            <td>{{ formatSymbol(data[dynamicField]) || 'N/A' }}</td>
                                            <td>{{ data[dynamicFieldData] || 'N/A' }}</td>
                                          </ng-container>
                                        </tr>
                                        <tr *ngIf="listData?.length == 0">
                                          <td colspan="7" class="text-center">No data available.</td>
                                        </tr>
                                      </tbody>
                                    </table>
                                  </div>
                                  <!-- End Table Data -->
                                  <!-- Pagination -->
                                  <div class="row justify-content-md-between align-items-md-center">
                                    <div class="col col-sm-6">
                                      <div class="dataTables_info mb-2" id="tickets-table_info" role="status"
                                        aria-live="polite">
                                        {{ getShowingText() }} of {{ totalRecords }} entries
                                      </div>
                                    </div>
                                    <div class="col col-sm-6">
                                      <div class="pagination justify-content-end">
                                        <ngb-pagination [collectionSize]="totalRecords" [(page)]="page"
                                          [pageSize]="pageSize" [maxSize]="3" [ellipses]="false"></ngb-pagination>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </ng-container>
                        </div>
                      </ng-template>
                    </li>
                    <li [ngbNavItem]="5" class="nav-item">
                      <a ngbNavLink class="nav-link animated-element" data-bs-toggle="tab" role="tab"
                        (click)="fetchDataResultPreformCheck('result_preform_check')">
                        <span class="step-title me-2">
                          Preform check Result
                        </span>
                      </a>
                      <ng-template ngbNavContent>
                        <div class="tab-content">
                          <ng-container>
                            <div class="row">
                              <div class="col-xl-3 col-md-6">
                                <div class="row">
                                  <div *ngFor="let section of dataSectionsPreformCheck" class="col-lg-12">
                                    <div class="card card-animate no-shadow-{{ section.color }}"
                                      (click)="toggleTabPreformCheck(section)">
                                      <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                          <div>
                                            <h5 class="mb-3 text-primary">
                                              {{ section.title }}
                                            </h5>
                                            <div class="d-flex mb-1">
                                              <p class="text-truncate fw-bold fs-15 mb-0">
                                                max: {{ formatNumber(tabDataPreform?.[0]?.[section.maxKey]) || 'N/A' }}
                                              </p>
                                            </div>
                                            <div class="d-flex mb-1">
                                              <p class="text-truncate fw-bold fs-15 mb-0">
                                                min: {{ formatNumber(tabDataPreform?.[0]?.[section.minKey]) || 'N/A' }}
                                              </p>
                                            </div>
                                            <div class="d-flex mb-1">
                                              <p class="text-truncate fw-bold fs-15 mb-0">
                                                avg: {{ formatNumber(tabDataPreform?.[0]?.[section.avgKey]) || 'N/A' }}
                                              </p>
                                            </div>

                                          </div>
                                          <div>
                                            <i-feather name="external-link"
                                              class="text-primary feather-icon-align"></i-feather>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>

                                  <!-- end col -->
                                </div>
                                <!-- end row -->
                              </div>
                              <!-- Filtering Table Data -->
                              <div class="col-xl-9 col-md-6">
                                <div class="row">
                                  <!-- Filtering Table Data -->
                                  <div class="col-md-6">
                                    <div class="search-box">
                                      <input type="text" #searchInput class="form-control search"
                                        placeholder="Search..." (input)="onSearchAll(searchInput.value)" />
                                      <i class="ri-search-line search-icon"></i>
                                    </div>
                                  </div>
                                  <div class="col-md-6">
                                    <div style="float: right;">
                                      <span style="margin-right: 4px;">Show</span>
                                      <select class="data rounded-3" id="pageSizeDropdown" #pageSizeDropdown
                                        [value]="pageSize" (change)="onPageSizeChange(pageSizeDropdown.value)">
                                        <option value="1">1</option>
                                        <option value="5">5</option>
                                        <option value="10">10</option>
                                        <option value="15">15</option>
                                        <option value="20">20</option>
                                        <option value="25">25</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                      </select>
                                      <span style="margin-left: 4px;">Data</span>
                                    </div>
                                  </div>
                                </div>
                                <div class="row mt-3">
                                  <div class="table-responsive">
                                    <table class="table table-gridjs">
                                      <thead>
                                        <tr>
                                          <th scope="col" class="text-center">No</th>
                                          <th scope="col">Lot No</th>
                                          <th scope="col">Pro</th>
                                          <th scope="col">Nomer Cav</th>
                                          <th scope="col">Jenis Botol</th>
                                          <th scope="col">STD {{ dynamicHeader }}</th>
                                      
                                          <!-- Check if it's a single field or multiple fields for dynamicHeader -->
                                          <ng-container *ngIf="isDynamicFieldArray; else singleFieldHeader">
                                            <th scope="col" *ngFor="let item of dynamicFieldData; let i = index">{{ dynamicHeader }} {{ i + 1 }}</th>
                                          </ng-container>
                                      
                                          <ng-template #singleFieldHeader>
                                            <th scope="col">{{ dynamicHeader }}</th>
                                          </ng-template>
                                      
                                        </tr>
                                      </thead>
                                      
                                      <tbody>
                                        <tr *ngFor="let data of listData; let i = index">
                                          <ng-container *ngIf="i >= (page - 1) * pageSize && i < page * pageSize">
                                            <td class="text-center">{{ i + 1 }}</td>
                                            <td>{{ data['lotno'] }}</td>
                                            <td>{{ data['pro'] }}</td>
                                            <td>{{ data['cavity_number'] }}</td>
                                            <td>{{ data['product'] }}</td>
                                            <td>{{ formatSymbol(data[dynamicField]) || 'N/A' }}</td>
                                        
                                            <!-- For each item in dynamicFieldData, display it in separate td -->
                                            <ng-container *ngIf="isDynamicFieldArray">
                                              <td *ngFor="let item of dynamicFieldData">
                                                {{ data[item] || 'N/A' }}
                                              </td>
                                            </ng-container>
                                            
                                            <!-- If not an array, display it in a single td -->
                                            <ng-container *ngIf="!isDynamicFieldArray">
                                              <td>
                                                {{ data[dynamicFieldData] || 'N/A' }}
                                              </td>
                                            </ng-container>
                                        
                                            <!-- Standard value -->
                                          </ng-container>
                                        </tr>
                                        
                                      
                                        <!-- No data case -->
                                        <tr *ngIf="listData?.length == 0">
                                          <td colspan="7" class="text-center">No data available.</td>
                                        </tr>
                                      </tbody>
                                      
                                    </table>
                                  </div>
                                  <!-- End Table Data -->
                                  <!-- Pagination -->
                                  <div class="row justify-content-md-between align-items-md-center">
                                    <div class="col col-sm-6">
                                      <div class="dataTables_info mb-2" id="tickets-table_info" role="status"
                                        aria-live="polite">
                                        {{ getShowingText() }} of {{ totalRecords }} entries
                                      </div>
                                    </div>
                                    <div class="col col-sm-6">
                                      <div class="pagination justify-content-end">
                                        <ngb-pagination [collectionSize]="totalRecords" [(page)]="page"
                                          [pageSize]="pageSize" [maxSize]="3" [ellipses]="false"></ngb-pagination>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </ng-container>
                        </div>
                      </ng-template>
                    </li>
                    <li [ngbNavItem]="6" class="nav-item">
                      <a ngbNavLink class="nav-link animated-element" data-bs-toggle="tab" role="tab"
                        (click)="fetchDataResultCCP('result_ccp')">
                        <span class="step-title me-2"> CCP Result </span>
                      </a>
                      <ng-template ngbNavContent>
                        <div *ngIf="dataResultCCP; else loadingTemplate">
                          <div class="row">
                            <div class="col-xl-3 col-md-6">
                              <div class="row">
                                <div *ngFor="let section of dataSections" class="col-lg-12">
                                  <div class="card card-animate no-shadow-{{
                                      section.color
                                    }}" (click)="changeChart(section)">
                                    <div class="card-body">
                                      <div class="d-flex justify-content-between">
                                        <div>
                                          <h5 class="mb-3 text-primary">
                                            {{ section.title }}
                                          </h5>
                                          <div class="d-flex mb-1">
                                            <p class="text-truncate fw-bold fs-15 mb-0">
                                              max :
                                              {{
                                              formatNumber(
                                              dataResultCCP[section.maxKey]
                                              )
                                              }}
                                            </p>
                                          </div>
                                          <div class="d-flex mb-1">
                                            <p class="text-truncate fw-bold fs-15 mb-0">
                                              min :
                                              {{
                                              formatNumber(
                                              dataResultCCP[section.minKey]
                                              )
                                              }}
                                            </p>
                                          </div>
                                          <div class="d-flex mb-1">
                                            <p class="text-truncate fw-bold fs-15 mb-0">
                                              avg :
                                              {{
                                              formatNumber(
                                              dataResultCCP[section.avgKey]
                                              )
                                              }}
                                            </p>
                                          </div>
                                        </div>
                                        <div>
                                          <div>
                                            <i-feather name="external-link" class="text-primary feather-icon-align">
                                            </i-feather>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                    <!-- end card body -->
                                  </div>
                                  <!-- end card -->
                                </div>
                                <!-- end col -->
                              </div>
                              <!-- end row -->
                            </div>
                            <div class="col-xl-9 col-md-6">
                              <div class="card-header border-0 align-items-center d-flex">
                                <h4 class="mb-0 flex-grow-1 fw-bold">
                                  {{ activeTitle }}
                                </h4>
                                <div class="hstack gap-1">
                                  <!-- sebelah kanan-->
                                </div>
                              </div>
                              <div *ngIf="chartRendered">
                                <!-- <apx-chart [series]="chartDataCCP.series" [chart]="chartDataCCP.chart"
                                  [dataLabels]="chartDataCCP.dataLabels" [stroke]="chartDataCCP.stroke"
                                  [xaxis]="chartDataCCP.xaxis" [colors]="chartDataCCP.colors" dir="ltr">
                                </apx-chart> -->
                                <!-- <apx-chart [series]="chartDataCCP.series" [chart]="chartDataCCP.chart"
                                  [xaxis]="chartDataCCP.xaxis" [yaxis]="chartDataCCP.yaxis"
                                  [dataLabels]="chartDataCCP.dataLabels" [stroke]="chartDataCCP.stroke"
                                  [annotations]="chartDataCCP.annotations" [title]="chartDataCCP.title"
                                  [colors]="chartDataCCP.colors">
                                </apx-chart> -->

                                <highcharts-chart [Highcharts]="Highcharts" [options]="chartOptions" [update]="true"
                                  style="width: 100%; height: 520px; display: block;">
                                </highcharts-chart>
                              </div>
                              <div *ngIf="chartRendered" class="card-header border-0 mt-2">
                                <div class="mb-2">
                                  <h6>
                                    Standard :
                                    <small class="text-muted fs-13 fw-normal">
                                      {{ dataStandard.min }}
                                      {{ dataStandard.unit || "" }} -
                                      {{ dataStandard.max }}
                                      {{ dataStandard.unit || "" }}
                                    </small>
                                  </h6>
                                </div>
                                <div class="d-flex flex-wrap gap-2 align-items-center">
                                  <h6>Status :</h6>

                                  <button type="button" class="btn btn-label rounded-pill" [ngClass]="
                                      dataStandard.status === 'Comply'
                                        ? 'btn-info'
                                        : 'btn-danger'
                                    ">
                                    <i class="ri-check-double-fill label-icon align-middle rounded-pill fs-16 me-2"></i>
                                    {{ dataStandard.status }}
                                  </button>
                                  <!-- <button
                                    type="button"
                                    class="btn"
                                    [ngClass]="
                                      dataStandard.status === 'Comply'
                                        ? 'btn-primary'
                                        : 'btn-danger'
                                    "
                                  >
                                    {{ dataStandard.status }}
                                  </button> -->
                                </div>
                              </div>
                              <div *ngIf="!chartRendered">
                                <h4 class="no-data">No Data</h4>
                              </div>
                            </div>
                          </div>
                        </div>
                        <ng-template #loadingTemplate>
                          <p>Data not found</p>
                          <!-- Tampilkan loading indicator saat data belum tersedia -->
                        </ng-template>
                      </ng-template>
                    </li>
                    <li [ngbNavItem]="7" class="nav-item">
                      <a ngbNavLink class="nav-link animated-element" data-bs-toggle="tab" role="tab">
                        <span class="step-title me-2">
                          Preparation Syrup Result
                        </span>
                      </a>
                      <ng-template ngbNavContent>
                        <p>Preparation Syrup Data has not yet been mapped</p>
                      </ng-template>
                    </li>
                    <li [ngbNavItem]="8" class="nav-item">
                      <a ngbNavLink class="nav-link animated-element" data-bs-toggle="tab" role="tab"
                        (click)="fetchDataResultAbnormally('result_abnormally')">
                        <span class="step-title me-2"> Abnormally Result </span>
                      </a>

                      <ng-template ngbNavContent>
                        <div class="tab-container">
                          <!-- Kotak hiasan dan kotak tab -->
                          <div class="tab-box-grey">
                            Lot No. {{ productLotNo }}
                          </div>
                          <div class="tab-box" [class.active]="isTabActive" (click)="toggleTab()">
                            Summary
                          </div>
                        </div>

                        <!-- Konten yang berubah berdasarkan status tab -->
                        <div class="tab-content">
                          <div *ngIf="!isTabActive">
                            <!-- Konten awal saat tab belum aktif -->
                            <apx-chart [series]="dataResultAbnormallyChart.series"
                              [chart]="dataResultAbnormallyChart.chart"
                              [dataLabels]="dataResultAbnormallyChart.dataLabels"
                              [plotOptions]="dataResultAbnormallyChart.plotOptions"
                              [yaxis]="dataResultAbnormallyChart.yaxis" [xaxis]="dataResultAbnormallyChart.xaxis"
                              [legend]="dataResultAbnormallyChart.legend" [colors]="dataResultAbnormallyChart.colors"
                              [grid]="dataResultAbnormallyChart.grid" dir="ltr">
                            </apx-chart>
                          </div>
                          <ng-container *ngIf="isTabActive">
                            <div class="row">
                              <!-- Filtering Table Data -->
                              <div class="col-md-6">
                                <div class="search-box">
                                  <input type="text" #searchInput class="form-control search" placeholder="Search..."
                                    (input)="onSearch(searchInput.value)" />
                                  <i class="ri-search-line search-icon"></i>
                                </div>
                              </div>
                              <div class="col-md-6">
                                <div style="float: right;">
                                  <span style="margin-right: 4px;">Show</span>
                                  <select class="data rounded-3" id="pageSizeDropdown" #pageSizeDropdown
                                    [value]="pageSize" (change)="onPageSizeChange(pageSizeDropdown.value)">
                                    <option value="1">1</option>
                                    <option value="5">5</option>
                                    <option value="10">10</option>
                                    <option value="15">15</option>
                                    <option value="20">20</option>
                                    <option value="25">25</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                  </select>
                                  <span style="margin-left: 4px;">Data</span>
                                </div>
                              </div>
                            </div>
                            <div class="row mt-3">
                              <div class="table-responsive">
                                <table class="table table-gridjs">
                                  <thead>
                                    <tr>
                                      <th scope="col" class="text-center">No</th>
                                      <th scope="col">Start Time</th>
                                      <th scope="col">End Time</th>
                                      <th scope="col">Alarm Code</th>
                                      <th scope="col">Reason Description</th>
                                      <th scope="col">Problem</th>
                                      <th scope="col">Cause</th>
                                      <th scope="col">Action </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr *ngFor="let data of listData; let i = index">
                                      <ng-container *ngIf="i >= (page - 1) * pageSize && i < page * pageSize">
                                        <td class="text-center">{{ i + 1 }}</td>
                                        <td>{{ formatDateToIndonesian(data['start_time']) }}</td>
                                        <td>{{ formatDateToIndonesian(data['end_time']) }}</td>
                                        <td>{{ data['alarm_code'] }}</td>
                                        <td>{{ data['desc'] }}</td>
                                        <td>{{ data['problem'] }}</td>
                                        <td>{{ data['penyebab'] }}</td>
                                        <td>{{ data['action'] }}</td>


                                      </ng-container>
                                    </tr>
                                    <tr *ngIf="listData?.length == 0">
                                      <td colspan="8" class="text-center">No data available.</td>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                              <!-- End Table Data -->
                              <!-- Pagination -->
                              <div class="row justify-content-md-between align-items-md-center">
                                <div class="col col-sm-6">
                                  <div class="dataTables_info mb-2" id="tickets-table_info" role="status"
                                    aria-live="polite">
                                    {{ getShowingText() }} of {{ totalRecords }} entries
                                  </div>
                                </div>
                                <div class="col col-sm-6">
                                  <div class="pagination justify-content-end">
                                    <ngb-pagination [collectionSize]="totalRecords" [(page)]="page"
                                      [pageSize]="pageSize" [maxSize]="3" [ellipses]="false"></ngb-pagination>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </ng-container>
                        </div>
                      </ng-template>
                    </li>
                    <li [ngbNavItem]="9" class="nav-item">
                      <a ngbNavLink class="nav-link animated-element" data-bs-toggle="tab" role="tab">
                        <span class="step-title me-2">
                          Operator Manual Insp.Result
                        </span>
                      </a>
                      <ng-template ngbNavContent>
                        <p>Data has not yet been mapped</p>
                      </ng-template>
                    </li>
                    <li [ngbNavItem]="10" class="nav-item">
                      <a ngbNavLink class="nav-link animated-element" data-bs-toggle="tab" role="tab">
                        <span class="step-title me-2">
                          Botlle Preasure Result
                        </span>
                      </a>
                      <ng-template ngbNavContent>
                        <p>Data has not yet been mapped</p>
                      </ng-template>
                    </li>
                    <li [ngbNavItem]="11" class="nav-item">
                      <a ngbNavLink class="nav-link animated-element" data-bs-toggle="tab" role="tab">
                        <span class="step-title me-2">
                          Packaging Material Result
                        </span>
                      </a>
                      <ng-template ngbNavContent>
                        <p>Data has not yet been mapped</p>
                      </ng-template>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="col-lg-10">
                <div class="px-lg-4">
                  <div class="tab-content">
                    <div [ngbNavOutlet]="customNav"></div>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
      <!-- end card-body -->
    </div>
    <!-- end card -->
  </div>
</div>
